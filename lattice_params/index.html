
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Cryo-ET image analysis tool for cylindric periodic structures such as microtubules.">
      
      
      
      
        <link rel="prev" href="../fit_splines/">
      
      
        <link rel="next" href="../inspect_results/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>Measure Lattice Parameters - Cylindra</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="slate" data-md-color-primary="lime" data-md-color-accent="light-green">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#measure-lattice-parameters" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Cylindra" class="md-header__button md-logo" aria-label="Cylindra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Cylindra
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Measure Lattice Parameters
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="lime" data-md-color-accent="light-green"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="lime" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/hanjinliu/cylindra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cylindra
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Cylindra" class="md-nav__button md-logo" aria-label="Cylindra" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Cylindra
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/hanjinliu/cylindra" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    cylindra
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Overview
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../installation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installation
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../basics/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Basics
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Usage
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Usage
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../open_image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Start Cylindra
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../fit_splines/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Fit Splines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Measure Lattice Parameters
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Measure Lattice Parameters
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#estimate-the-radius" class="md-nav__link">
    <span class="md-ellipsis">
      Estimate the Radius
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Estimate the Radius">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-global-radius" class="md-nav__link">
    <span class="md-ellipsis">
      The global radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-global-radius-manually" class="md-nav__link">
    <span class="md-ellipsis">
      Set global radius manually
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-local-radius" class="md-nav__link">
    <span class="md-ellipsis">
      The local radius
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infer-polarity" class="md-nav__link">
    <span class="md-ellipsis">
      Infer Polarity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-cft" class="md-nav__link">
    <span class="md-ellipsis">
      Running CFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running CFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-cft" class="md-nav__link">
    <span class="md-ellipsis">
      local-CFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-cft" class="md-nav__link">
    <span class="md-ellipsis">
      global-CFT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties-of-the-splines" class="md-nav__link">
    <span class="md-ellipsis">
      Properties of the Splines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sweep-along-the-splines" class="md-nav__link">
    <span class="md-ellipsis">
      Sweep along the Splines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-this-workflow-easily" class="md-nav__link">
    <span class="md-ellipsis">
      Run this workflow easily
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../inspect_results/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inspect CFT Results
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../project_io/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Load &amp; Save Projects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../workflows/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Custom Workflows
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../spline/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Spline
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_7" id="__nav_4_7_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_7">
            <span class="md-nav__icon md-icon"></span>
            Spline
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spline/clip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clip and Invert Splines
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../spline/config/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spline Configurations
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_8" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../molecules/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Molecules
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_8" id="__nav_4_8_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_8">
            <span class="md-nav__icon md-icon"></span>
            Molecules
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/spline_to_molecules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spline to Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/features/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Molecule Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/expressions/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    The "Expressions"
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/split_and_combine/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Split &amp; Combine Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/filter_molecules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Filter Molecules by Features
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/transform/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Transform Molecules
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../molecules/headers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Feature Names
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_9" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../alignment/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Alignment
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_9" id="__nav_4_9_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_9">
            <span class="md-nav__icon md-icon"></span>
            Alignment
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alignment/conventional/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Conventional Methods in Cryo-ET Studies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alignment/landscape/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Build Correlation Landscapes
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alignment/viterbi/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Viterbi Alignment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../alignment/rma/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Restricted Mesh Annealing (RMA)
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_10" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../batch/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Working with Many Projects
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_10" id="__nav_4_10_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_10">
            <span class="md-nav__icon md-icon"></span>
            Working with Many Projects
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/collect_projects/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collect projects
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/construct/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Construct Batch Loaders
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../batch/average/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Average Across Projects
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_11" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../extern/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Working with External Softwares
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_11" id="__nav_4_11_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_11">
            <span class="md-nav__icon md-icon"></span>
            Working with External Softwares
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extern/imod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    IMOD
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../extern/relion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RELION
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../process_images/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Process Images
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../simulate/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simulate Tomograms
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../cli/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CLI Usage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_15" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../case_studies/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Case Studies
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4_15" id="__nav_4_15_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_15_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_15">
            <span class="md-nav__icon md-icon"></span>
            Case Studies
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../case_studies/seam_search/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microtubule Seam-search
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../case_studies/ssta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Segmented Subtomogram Averaging (SSTA)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../case_studies/make_figure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Microtubule for Figures
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../api/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    API References
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            API References
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/components/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.components
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/core/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.core
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/project/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.project
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/cylmeasure/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.cylmeasure
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/cylfilters/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.cylfilters
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/ext/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.ext
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5_8" >
        
          
          <label class="md-nav__link" for="__nav_5_8" id="__nav_5_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Widgets
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_5_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5_8">
            <span class="md-nav__icon md-icon"></span>
            Widgets
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/widgets/main/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.widgets.main.CylindraMainWidget
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/widgets/sta/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.widgets.sta.SubtomogramAveraging
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/widgets/subwidgets/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.widgets.subwidgets
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/widgets/batch/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cylindra.widgets.batch
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#estimate-the-radius" class="md-nav__link">
    <span class="md-ellipsis">
      Estimate the Radius
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Estimate the Radius">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-global-radius" class="md-nav__link">
    <span class="md-ellipsis">
      The global radius
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#set-global-radius-manually" class="md-nav__link">
    <span class="md-ellipsis">
      Set global radius manually
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-local-radius" class="md-nav__link">
    <span class="md-ellipsis">
      The local radius
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#infer-polarity" class="md-nav__link">
    <span class="md-ellipsis">
      Infer Polarity
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#running-cft" class="md-nav__link">
    <span class="md-ellipsis">
      Running CFT
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Running CFT">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#local-cft" class="md-nav__link">
    <span class="md-ellipsis">
      local-CFT
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#global-cft" class="md-nav__link">
    <span class="md-ellipsis">
      global-CFT
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#properties-of-the-splines" class="md-nav__link">
    <span class="md-ellipsis">
      Properties of the Splines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#sweep-along-the-splines" class="md-nav__link">
    <span class="md-ellipsis">
      Sweep along the Splines
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#run-this-workflow-easily" class="md-nav__link">
    <span class="md-ellipsis">
      Run this workflow easily
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="measure-lattice-parameters">Measure Lattice Parameters</h1>
<p>In this section, we'll see how to measure the lattice parameters and store the results
in the <code>Spline</code> object.</p>
<h2 id="estimate-the-radius">Estimate the Radius</h2>
<h3 id="the-global-radius">The global radius</h3>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.measure_radius"><code>measure_radius</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Analysis &gt; Radius &gt; Measure radius</code></p>
<p>To run many of the lattice analyses, you have to know the size of the cylinders.
This is the simplest method to estimate the radius using the radial profile of sampled
sub-volumes along the spline. This method should only be used if the radius is almost
constant along the cylindric structure.</p>
<p><img alt="Measure radius" loading="lazy," src="../images/measure_radius.png" width="400px" /></p>
<details class="info">
<summary>List of parameters</summary>
<ol>
<li>The registered splines should be shown in the top "splines" row.</li>
<li>Available bin sizes are shown in the "bin size" combo box. Since peak detection
   is performed by calculating the centroid, scaling down does not affect a lot.
   usually ~0.5 nm/pixel is enough.</li>
<li>"min radius" is the minimum radius to be considered as a valid peak.</li>
</ol>
</details>
<p>After this estimation, the radius is stored as a global property of the spline. It is
available in the <code>spline</code> properties.</p>
<div class="highlight"><pre><span></span><code><span class="n">spl</span> <span class="o">=</span> <span class="n">ui</span><span class="o">.</span><span class="n">splines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>  <span class="c1"># the first Spline object</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spl</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get_glob</span><span class="p">(</span><span class="s2">&quot;radius&quot;</span><span class="p">))</span>  <span class="c1"># print the global radius of the spline</span>
<span class="nb">print</span><span class="p">(</span><span class="n">spl</span><span class="o">.</span><span class="n">radius</span><span class="p">)</span>  <span class="c1"># a shorthand for spl.props.get_glob(&quot;radius&quot;)</span>
</code></pre></div>
<details class="info">
<summary>If the estimated value is not appropriate</summary>
<ul>
<li>If you forgot to invert the image, this step will be the first step that the
  result goes wrong. Make sure the image is inverted.</li>
<li>This method uses the radial profile of the raw intensity values. If the cylinder
  structure is coated with dense components inside and/or outside of the cylinder,
  the result will be affected. If there's any a priori knowledge about the radius,
  you can set it manually with <a href="#set-global-radius-manually"><code>set_radius</code> method</a>.</li>
</ul>
</details>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the cylinder structure is supposed to change, you may want to
<a href="#the-local-radius">measure local radius</a>.</p>
</div>
<h3 id="set-global-radius-manually">Set global radius manually</h3>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.set_radius"><code>set_radius</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Analysis &gt; Radius &gt; Set radius</code></p>
<p>If you already know the radius, or the rule to calculate the radius, you can set it
manually. If the latter, you'll use the <a href="../molecules/expressions/">expression system</a>.</p>
<p><img alt="Set radius" loading="lazy," src="../images/set_radius.png" width="400px" /></p>
<details class="info">
<summary>List of parameters</summary>
<ol>
<li>The registered splines should be shown in the top "splines" row.</li>
<li>"radius" is the radius in nm. If a scalar is given, radii of all the selected
   splines will be updated with the same value. If an expression is given, radius
   values will be calculated by evaluating the expression using the global
   properties of the spline.</li>
</ol>
</details>
<details class="example">
<summary>set radius using an expression</summary>
<p>Calculate the radius based on the number of protofilaments.</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">set_radius</span><span class="p">(</span><span class="n">splines</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="s2">&quot;col(&#39;npf&#39;) * 0.78&quot;</span><span class="p">)</span>
</code></pre></div>
<p>The <a href="https://docs.pola.rs/py-polars/html/reference/expressions/api/polars.Expr.replace.html">replace</a>
method is useful to map the number of protofilaments to the radius value.</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">set_radius</span><span class="p">(</span><span class="n">splines</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">radius</span><span class="o">=</span><span class="s2">&quot;col(&#39;npf&#39;).replace({13: 10.0, 14: 11.0})&quot;</span><span class="p">)</span>
</code></pre></div>
</details>
<h3 id="the-local-radius">The local radius</h3>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.measure_local_radius"><code>measure_local_radius</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Analysis &gt; Radius &gt; Measure local radius</code></p>
<p>In some cases, the radius is not constant. This method will measure the radius of each
sub-volume along the spline and store it as a local property of the spline.</p>
<p><img alt="Measure local radius" loading="lazy," src="../images/measure_local_radius.png" width="400px" /></p>
<details class="info">
<summary>List of parameters</summary>
<ol>
<li>The registered splines should be shown in the top "splines" row.</li>
<li>"interval" is the sampling interval in nm. If you already analyzed some local
   parameters, the spline should be tagged with the anchors. In this case, you can
   directly use the anchors instead of manually setting this value.</li>
<li>"depth" is the size of sub-volumes in nm parallel to the spline.</li>
<li>Available bin sizes are shown in the "bin size" combo box. Since peak detection
   is performed by calculating the centroid, scaling down does not affect a lot.
   usually ~0.5 nm/pixel is enough.</li>
<li>"min radius" is the minimum radius to be considered as a valid peak.</li>
<li>If you want to update the global property of "radius" by the mean of local
   radius, check the "Also update the global radius" checkbox.</li>
</ol>
</details>
<h2 id="infer-polarity">Infer Polarity</h2>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.infer_polarity"><code>infer_polarity</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Splines &gt; Orientation &gt; Infer polarity</code></p>
<p>Many biological filamentous structures have polarity. This feature usually needs to be
determined by subtomogram averaging, but in some cases we can undoubtedly distinguish
the polarity by seeing the chirality of the molecules.</p>
<p>In <code>cylindra</code>, an automatic polarity inference method is implemented. This method works
very well for microtubules, using the fact that clockwise appearance of tubulin
molecules corresponds to the minus-to-plus direction. Theoretically, it should also
work for other helical structures such as actin filament, but it's not guaranteed.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If the polarity is not inferred correctly, you can set it manually using the
<a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.set_spline_props"><code>set_spline_props</code> method</a>.</p>
</div>
<h2 id="running-cft">Running CFT</h2>
<p>CFT (cylindric Fourier Transformation) is a method introduced in our work to measure
the local and global lattice parameters of microtubules. It composed of following steps:</p>
<ol>
<li>Coordinate transformation from the Cartesian coordinate <span class="arithmatex">\((z, y, x)\)</span> to the
   cylindrical coordinate <span class="arithmatex">\((r, y', \theta)\)</span>.</li>
<li>3D Discrete Fourier Transformation around the peak locations with up-sampling. The
   expected peak locations are defined in the spline configurations.</li>
<li>Project the 3D cylindric power spectrum to <span class="arithmatex">\((y', \theta)\)</span>. The peak frequencies are
   used to calculate the lattice parameters.</li>
</ol>
<p>Note that the <span class="arithmatex">\(y'\)</span> coordinate is parallel to the spline in the Cartesian coordinate.
If the tilt axis of your tomogram is <span class="arithmatex">\(y\)</span>, you should have drawn splines almost parallel
to the <span class="arithmatex">\(y\)</span> axis. Therefore, you can assume <span class="arithmatex">\(y \approx y'\)</span>.</p>
<details class="info">
<summary>Why not FFT?</summary>
<p>The FFT (Fast Fourier Transformation) is a widely used algorithm to calculate the
Fourier Transformation very efficiently. However, FFT is not suitable for
up-sampling because it results in a very large output image (10&times; up-sampling
in two axes results in a 100&times; larger image). In this case, discrete Fourier
transformation is must faster and more memory efficient.</p>
</details>
<p>After the radius is estimated, you can run CFT to measure the lattice parameters.</p>
<h3 id="local-cft">local-CFT</h3>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.local_cft_analysis"><code>local_cft_analysis</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Analysis &gt; Local CFT analysis</code></p>
<p>Local-CFT is a CFT analysis performed by building local cylindric coordinate systems
along the spline. The local coordinate system is "straight"; the <span class="arithmatex">\(y'\)</span> axis is not
curved when it's viewed in the Cartesian coordinate system.</p>
<p><img alt="Local CFT" loading="lazy," src="../images/local_cft_analysis.png" width="400px" /></p>
<details class="info">
<summary>List of parameters</summary>
<ol>
<li>The registered splines should be shown in the top "splines" row.</li>
<li>"interval" is the sampling interval in nm. You can use existing spline anchors
   if you already have ones, such as after running "Measure local radius".</li>
<li>"depth" is the size of sub-volumes in nm parallel to the spline (<span class="arithmatex">\(y'\)</span> axis).</li>
<li>Available bin sizes are shown in the "bin size" combo box. Since power spectra
   will be up-sampled, ~0.5 nm/pixel is usually enough.</li>
<li>If you want to build local cylindric coordinate systems using the global radius,
   the "radius" parameter should be "global". Change to "local" if you'll use the
   local radius.</li>
<li>If you want to update all the global properties, check the "Also update the
   global properties" checkbox.</li>
</ol>
</details>
<p>After local-CFT, the spline local properties are updated. You can access them as a
<code>DataFrame</code> by:</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">splines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">loc</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output:</span><pre><span></span><code>shape: (3, 8)
┌────────────┬─────────────┬──────────┬───┬─────┬───────┐
│ rise_angle ┆ rise_length ┆ pitch    ┆ … ┆ npf ┆ start │
│ ---        ┆ ---         ┆ ---      ┆   ┆ --- ┆ ---   │
│ f32        ┆ f32         ┆ f32      ┆   ┆ u8  ┆ i8    │
╞════════════╪═════════════╪══════════╪═══╪═════╪═══════╡
│ 9.999075   ┆ 0.944843    ┆ 4.099899 ┆ … ┆ 13  ┆ 3     │
│ 10.028508  ┆ 0.947809    ┆ 4.099899 ┆   ┆ 13  ┆ 3     │
│ 10.003416  ┆ 0.945541    ┆ 4.095563 ┆   ┆ 13  ┆ 3     │
└────────────┴─────────────┴──────────┴───┴─────┴───────┘
</code></pre></div>
<p>... or as a series:</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">splines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get_loc</span><span class="p">(</span><span class="s2">&quot;rise_angle&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output:</span><pre><span></span><code>shape: (3,)
Series: &#39;rise_angle&#39; [f32]
[
    9.999075
    10.028508
    10.003416
]
</code></pre></div>
<h3 id="global-cft">global-CFT</h3>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.global_cft_analysis"><code>global_cft_analysis</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Analysis &gt; Global CFT analysis</code></p>
<p>Unlike local-CFT, global-CFT builds a distorted cylindric coordinate system; The <span class="arithmatex">\(y'\)</span>
axis is exactly the spline. This coordinate mapping will straighten the lattice, which
makes it possible to measure the average lattice parameters.</p>
<p><img alt="Global CFT" loading="lazy," src="../images/global_cft_analysis.png" width="400px" /></p>
<details class="info">
<summary>List of parameters</summary>
<ol>
<li>The registered splines should be shown in the top "splines" row.</li>
<li>Available bin sizes are shown in the "bin size" combo box. Global-CFT uses a
   a very long region, you can use larger bin sizes.</li>
</ol>
</details>
<p>This method will update the global properties of the spline. You can access them
similarly.</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">splines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">glob</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output:</span><pre><span></span><code>┌───────────┬─────────────┬────────────┬───┬──────────┬─────┬───────┐
│ radius    ┆ orientation ┆ rise_angle ┆ … ┆ twist    ┆ npf ┆ start │
│ ---       ┆ ---         ┆ ---        ┆   ┆ ---      ┆ --- ┆ ---   │
│ f32       ┆ str         ┆ f32        ┆   ┆ f32      ┆ u8  ┆ i8    │
╞═══════════╪═════════════╪════════════╪═══╪══════════╪═════╪═══════╡
│ 11.086255 ┆ MinusToPlus ┆ 10.027519  ┆ … ┆ 0.036526 ┆ 13  ┆ 3     │
└───────────┴─────────────┴────────────┴───┴──────────┴─────┴───────┘
</code></pre></div>
<p>... or as a scalar:</p>
<div class="highlight"><pre><span></span><code><span class="n">ui</span><span class="o">.</span><span class="n">splines</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">props</span><span class="o">.</span><span class="n">get_glob</span><span class="p">(</span><span class="s2">&quot;rise_angle&quot;</span><span class="p">)</span>
</code></pre></div>
<div class="highlight"><span class="filename">Output:</span><pre><span></span><code>10.027519226074219
</code></pre></div>
<h2 id="properties-of-the-splines">Properties of the Splines</h2>
<p>After running CFT, splines will have the following properties:</p>
<ol>
<li><code>"rise_angle"</code></li>
<li><code>"rise_length"</code></li>
<li><code>"pitch"</code></li>
<li><code>"spacing"</code></li>
<li><code>"skew_angle"</code></li>
<li><code>"twist"</code></li>
<li><code>"radius"</code></li>
<li><code>"npf"</code></li>
<li><code>"start"</code></li>
<li><code>"orientation"</code> (global only)</li>
</ol>
<p><img alt="Definition of lattice parameters" loading="lazy," src="../images/lattice_params.png" width="320px" /></p>
<h2 id="sweep-along-the-splines">Sweep along the Splines</h2>
<p>After running local-CFT, you'll find the GUI being updated.</p>
<p>In the "Spline Control" panel, you can check the fitting results by seeing the
projections of each sub-volume along the spline.</p>
<p><img alt="SplineControl" loading="lazy," src="../images/spline_control.png" width="400px" /></p>
<p>Local lattice parameters are plotted in the "Local Properties" panel. You can
interactively see the profiles in the figures.</p>
<p><img alt="LocalProperties" loading="lazy," src="../images/local_props_gui.png" width="400px" /></p>
<h2 id="run-this-workflow-easily">Run this workflow easily</h2>
<p>The "fit &rarr; refine &rarr; measure radius &rarr; CFT" workflow can be quickly run
from the toolbar, or <span class="keys"><kbd class="key-f2">F2</kbd></span> key.</p>
<p><img alt="Runner" loading="lazy," src="../images/run_workflow_dialog.png" width="400px" /></p>
<details class="info">
<summary>Manually set parameters</summary>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> API: <a class="autorefs autorefs-internal" href="../api/widgets/main/#cylindra.widgets.main.CylindraMainWidget.set_spline_props"><code>set_spline_props</code></a></p>
<p><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.03 12c0-4.41-3.62-8.03-8.03-8.03-4.41 0-8.03 3.62-8.03 8.03 0 4.41 3.62 8.03 8.03 8.03 4.41 0 8.03-3.62 8.03-8.03M22 12c0 5.54-4.46 10-10 10S2 17.54 2 12 6.46 2 12 2s10 4.46 10 10m-8.46 1v3l3.96-4-3.96-4v3H6.5v2"/></svg></span> GUI: <code>Splines &gt; Set spline properties</code></p>
<p>This method is useful when you want to set the protofilament number, start number
and/or orientation of the splines manually, especially when the automatic inference
fails but you are sure about the values.</p>
</details>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../fit_splines/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Fit Splines">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Fit Splines
              </div>
            </div>
          </a>
        
        
          
          <a href="../inspect_results/" class="md-footer__link md-footer__link--next" aria-label="Next: Inspect CFT Results">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Inspect CFT Results
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright (c) 2023 - 2024 Hanjin Liu
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "..", "features": ["content.code.annotate", "content.code.copy", "navigation.sections", "navigation.indexes", "navigation.footer", "toc.follow", "search.suggest", "search.share"], "search": "../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>